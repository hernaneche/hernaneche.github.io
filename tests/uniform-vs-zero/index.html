<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Shooter: Universal Advantage</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: #ffcc00;
            text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #ccc;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .game-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        #gameCanvas {
            background: #000;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            flex: 2;
        }
        
        .sidebar {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .player-stats {
            background: rgba(0, 30, 60, 0.7);
            padding: 15px;
            border-radius: 8px;
        }
        
        .player-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .player-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .stat-bar {
            height: 10px;
            background: #333;
            border-radius: 5px;
            margin: 5px 0;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s;
        }
        
        .weapon-fill {
            background: linear-gradient(90deg, #00b4db, #0083b0);
        }
        
        .dependency-fill {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }
        
        .health-fill {
            background: linear-gradient(90deg, #4CAF50, #2E7D32);
        }
        
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }
        
        .control-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .key {
            display: inline-block;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            margin-top: 5px;
            font-weight: bold;
            color: #ffcc00;
        }
        
        .concept-explanation {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        .concept-title {
            color: #ffcc00;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        
        .concept-content {
            line-height: 1.6;
        }
        
        .highlight {
            color: #ffcc00;
            font-weight: bold;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        #startBtn {
            background: linear-gradient(90deg, #00b09b, #96c93d);
        }
        
        #pauseBtn {
            background: linear-gradient(90deg, #00b4db, #0083b0);
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            color: #ccc;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .game-container {
                flex-direction: column;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SPACE SHOOTER: UNIVERSAL ADVANTAGE</h1>
            <p class="subtitle">Where excessive power leads to self-destruction</p>
        </header>
        
        <div class="game-container">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            
            <div class="sidebar">
                <div class="player-stats">
                    <div class="player-title">
                        <div class="player-color" style="background-color: #ff3333;"></div>
                        <h3>Player 1</h3>
                    </div>
                    <div>Weapon Level: <span id="p1Weapon">1</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill weapon-fill" id="p1WeaponBar" style="width: 10%;"></div>
                    </div>
                    <div>Health: <span id="p1Health">3</span>/<span id="p1MaxHealth">3</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill health-fill" id="p1HealthBar" style="width: 100%;"></div>
                    </div>
                    <div>Dependency: <span id="p1Dependency">0%</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill dependency-fill" id="p1DependencyBar" style="width: 0%;"></div>
                    </div>
                    <div>Kills: <span id="p1Kills">0</span></div>
                </div>
                
                <div class="player-stats">
                    <div class="player-title">
                        <div class="player-color" style="background-color: #3333ff;"></div>
                        <h3>Player 2</h3>
                    </div>
                    <div>Weapon Level: <span id="p2Weapon">1</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill weapon-fill" id="p2WeaponBar" style="width: 10%;"></div>
                    </div>
                    <div>Health: <span id="p2Health">3</span>/<span id="p2MaxHealth">3</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill health-fill" id="p2HealthBar" style="width: 100%;"></div>
                    </div>
                    <div>Dependency: <span id="p2Dependency">0%</span></div>
                    <div class="stat-bar">
                        <div class="stat-fill dependency-fill" id="p2DependencyBar" style="width: 0%;"></div>
                    </div>
                    <div>Kills: <span id="p2Kills">0</span></div>
                </div>
                
                <div class="controls">
                    <div class="control-item">
                        <h4>Player 1 Controls</h4>
                        <p>Move: <span class="key">WASD</span></p>
                        <p>Shoot: <span class="key">Space</span></p>
                        <p>Direction: Last Movement</p>
                    </div>
                    <div class="control-item">
                        <h4>Player 2 Controls</h4>
                        <p>Move: <span class="key">Arrows</span></p>
                        <p>Shoot: <span class="key">Enter</span></p>
                        <p>Direction: Last Movement</p>
                    </div>
                </div>
                
                <div class="buttons">
                    <button id="startBtn">Start Game</button>
                    <button id="pauseBtn">Pause</button>
                </div>
            </div>
        </div>
        
        <div class="concept-explanation">
            <h3 class="concept-title">The Philosophy of Universal Advantage</h3>
            <div class="concept-content">
                <p><span class="highlight">"A 'improvement' that becomes universalized ceases to be an advantage, but creates dependency."</span></p>
                <p>This game demonstrates how the pursuit of excessive power ultimately leads to self-destruction. As weapon levels increase:</p>
                <ul>
                    <li>Higher levels provide temporary advantage</li>
                    <li>But create dependency on power-ups</li>
                    <li>At extreme sizes, weapons destroy everything in their radius - including their creator</li>
                    <li>This illustrates the futility of the arms race and the concept of "universal advantage"</li>
                </ul>
                <p>True power lies in balance, not in overwhelming force that ultimately consumes itself.</p>
            </div>
        </div>
        
        <div class="footer">
            <p>Created to demonstrate philosophical concepts through gameplay | Space Shooter: Universal Advantage</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            // Game state
            let gameRunning = false;
            let gamePaused = false;
            let lastTime = 0;
            let powerUpSpawnTimer = 0;
            let decayTimer = 0;
            
            // Players
            const players = [
                {
                    x: 200,
                    y: 300,
                    width: 40,
                    height: 40,
                    color: '#ff3333',
                    weaponLevel: 1,
                    health: 3,
                    maxHealth: 3,
                    dependency: 0,
                    kills: 0,
                    speed: 5,
                    cooldown: 0,
                    keys: {
                        up: 'KeyW',
                        down: 'KeyS',
                        left: 'KeyA',
                        right: 'KeyD',
                        shoot: 'Space'
                    },
                    activeKeys: {
                        up: false,
                        down: false,
                        left: false,
                        right: false
                    },
                    hitTimer: 0,
                    lastMoveX: 1,  // Default direction (right)
                    lastMoveY: 0
                },
                {
                    x: 600,
                    y: 300,
                    width: 40,
                    height: 40,
                    color: '#3333ff',
                    weaponLevel: 1,
                    health: 3,
                    maxHealth: 3,
                    dependency: 0,
                    kills: 0,
                    speed: 5,
                    cooldown: 0,
                    keys: {
                        up: 'ArrowUp',
                        down: 'ArrowDown',
                        left: 'ArrowLeft',
                        right: 'ArrowRight',
                        shoot: 'Enter'
                    },
                    activeKeys: {
                        up: false,
                        down: false,
                        left: false,
                        right: false
                    },
                    hitTimer: 0,
                    lastMoveX: -1,  // Default direction (left)
                    lastMoveY: 0
                }
            ];
            
            // Game objects
            const bullets = [];
            const powerUps = [];
            const explosions = [];
            
            // Initialize game
            function init() {
                bullets.length = 0;
                powerUps.length = 0;
                explosions.length = 0;
                
                players[0].x = 200;
                players[0].y = 300;
                players[0].weaponLevel = 1;
                players[0].health = 3;
                players[0].maxHealth = 3;
                players[0].dependency = 0;
                players[0].kills = 0;
                players[0].lastMoveX = 1;
                players[0].lastMoveY = 0;
                
                players[1].x = 600;
                players[1].y = 300;
                players[1].weaponLevel = 1;
                players[1].health = 3;
                players[1].maxHealth = 3;
                players[1].dependency = 0;
                players[1].kills = 0;
                players[1].lastMoveX = -1;
                players[1].lastMoveY = 0;
                
                updateUI();
            }
            
            // Start game
            document.getElementById('startBtn').addEventListener('click', function() {
                if (!gameRunning) {
                    gameRunning = true;
                    gamePaused = false;
                    init();
                    requestAnimationFrame(gameLoop);
                }
            });
            
            // Pause game
            document.getElementById('pauseBtn').addEventListener('click', function() {
                if (gameRunning) {
                    gamePaused = !gamePaused;
                    this.textContent = gamePaused ? 'Resume' : 'Pause';
                }
            });
            
            // Input handling
            document.addEventListener('keydown', function(e) {
                if (!gameRunning) return;
                
                players.forEach(player => {
                    if (e.code === player.keys.up) {
                        player.activeKeys.up = true;
                        player.lastMoveX = 0;
                        player.lastMoveY = -1;
                    }
                    if (e.code === player.keys.down) {
                        player.activeKeys.down = true;
                        player.lastMoveX = 0;
                        player.lastMoveY = 1;
                    }
                    if (e.code === player.keys.left) {
                        player.activeKeys.left = true;
                        player.lastMoveX = -1;
                        player.lastMoveY = 0;
                    }
                    if (e.code === player.keys.right) {
                        player.activeKeys.right = true;
                        player.lastMoveX = 1;
                        player.lastMoveY = 0;
                    }
                    if (e.code === player.keys.shoot && player.cooldown <= 0) {
                        shoot(player);
                        player.cooldown = 20 - (player.weaponLevel * 0.5);
                    }
                });
            });
            
            document.addEventListener('keyup', function(e) {
                players.forEach(player => {
                    if (e.code === player.keys.up) player.activeKeys.up = false;
                    if (e.code === player.keys.down) player.activeKeys.down = false;
                    if (e.code === player.keys.left) player.activeKeys.left = false;
                    if (e.code === player.keys.right) player.activeKeys.right = false;
                });
            });
            
            // Game loop
            function gameLoop(timestamp) {
                if (!gameRunning) return;
                
                const deltaTime = timestamp - lastTime;
                lastTime = timestamp;
                
                if (!gamePaused) {
                    update(deltaTime);
                }
                
                render();
                requestAnimationFrame(gameLoop);
            }
            
            // Update game state
            function update(deltaTime) {
                // Update players
                players.forEach(player => {
                    // Movement
                    if (player.activeKeys.up) {
                        player.y -= player.speed;
                        player.lastMoveX = 0;
                        player.lastMoveY = -1;
                    }
                    if (player.activeKeys.down) {
                        player.y += player.speed;
                        player.lastMoveX = 0;
                        player.lastMoveY = 1;
                    }
                    if (player.activeKeys.left) {
                        player.x -= player.speed;
                        player.lastMoveX = -1;
                        player.lastMoveY = 0;
                    }
                    if (player.activeKeys.right) {
                        player.x += player.speed;
                        player.lastMoveX = 1;
                        player.lastMoveY = 0;
                    }
                    
                    // Keep within bounds
                    player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
                    player.y = Math.max(0, Math.min(canvas.height - player.height, player.y));
                    
                    // Cooldown
                    if (player.cooldown > 0) player.cooldown--;
                    
                    // Hit timer
                    if (player.hitTimer > 0) player.hitTimer--;
                });
                
                // Update bullets
                for (let i = bullets.length - 1; i >= 0; i--) {
                    if (!bullets[i]) continue;
                    
                    bullets[i].x += bullets[i].speedX;
                    bullets[i].y += bullets[i].speedY;
                    
                    // Remove if out of bounds
                    if (bullets[i].x < 0 || bullets[i].x > canvas.width || 
                        bullets[i].y < 0 || bullets[i].y > canvas.height) {
                        bullets.splice(i, 1);
                        continue;
                    }
                    
                        
                        
                        // Damage all players within the explosion radius
                        players.forEach((player, index) => {
                            const dx = player.x + player.width/2 - bullets[i].x;
                            const dy = player.y + player.height/2 - bullets[i].y;
                            const distance = Math.sqrt(dx*dx + dy*dy);
                            
                            if (distance < bullets[i].radius) {
                                // Player is within explosion radius
                                player.health = 0;
                                
                                // If the player is not the shooter, give kill credit to shooter
                                if (index !== bullets[i].playerIndex) {
                                    players[bullets[i].playerIndex].kills++;
                                } /*else {
                                    // Self-destruction - philosophical concept of futility
                                    players[bullets[i].playerIndex].kills = Math.max(0, players[bullets[i].playerIndex].kills - 1);
                                }*/
                                
                                // Create individual explosion for player
                                createBigExplosion(player.x + player.width/2, player.y + player.height/2, player.weaponLevel);
                                
                                // Respawn player
                                respawnPlayer(player);
                            }
                        });
                        
                        // Remove all power-ups within explosion radius
                        for (let j = powerUps.length - 1; j >= 0; j--) {
                            const dx = powerUps[j].x - bullets[i].x;
                            const dy = powerUps[j].y - bullets[i].y;
                            const distance = Math.sqrt(dx*dx + dy*dy);
                            
                            if (distance < bullets[i].radius) {
                                powerUps.splice(j, 1);
                            }
                        }
                        
                        
                    
                    
                    // Normal bullet collision with players
                    for (let j = 0; j < players.length; j++) {
                        if (!bullets[i]) continue;
                        
                        if (bullets[i].playerIndex !== j && 
                            checkCollision(bullets[i], players[j]) &&
                            players[j].hitTimer <= 0) {
                            
                            // Calculate damage based on bullet level vs player level
                            const bulletLevel = bullets[i].level;
                            const playerLevel = players[j].weaponLevel;
                            
                            // Higher level bullets do more damage
                            if (bulletLevel > playerLevel) {
                                // One-hit kill if bullet level is higher than player level
                                players[j].health = 0;
                            } else {
                                // Reduce health by 1 for bullets of same or lower level
                                players[j].health -= 1;
                            }
                            
                            // Create explosion effect
                            createExplosion(players[j].x + players[j].width/2, players[j].y + players[j].height/2);
                            
                            //createSuperExplosion(bullets[i].x, bullets[i].y, bullets[i].radius);
                            // Set hit timer for invincibility frames
                            players[j].hitTimer = 20;
                            
                            // Remove bullet
                            bullets.splice(i, 1);
                            
                            // Check if player is destroyed
                            if (players[j].health <= 0) {
                                createBigExplosion(players[j].x + players[j].width/2, players[j].y + players[j].height/2, players[j].weaponLevel);
                                
                                // Increase killer's score
                                const shooterIndex = bullets[i] ? bullets[i].playerIndex : 0;
                                players[shooterIndex].kills++;
                                
                                // Respawn player
                                respawnPlayer(players[j]);
                            }
                            
                            updateUI();
                            break;
                        }
                    }
                }
                
                // Update power-ups
                powerUpSpawnTimer += deltaTime;
                if (powerUpSpawnTimer > 2000) {
                    spawnPowerUp();
                    powerUpSpawnTimer = 0;
                }
                
                for (let i = powerUps.length - 1; i >= 0; i--) {
                    // Check collision with players
                    for (let j = 0; j < players.length; j++) {
                        if (checkCollision(powerUps[i], players[j])) {
                            // Collect power-up
                            const maxLevel = 200; // upper limit
                            players[j].weaponLevel += (maxLevel - players[j].weaponLevel) * 0.2;
                            console.log("players[j].weaponLevel",players[j].weaponLevel);
                            players[j].dependency += 5;
                            players[j].maxHealth = Math.floor(players[j].weaponLevel) + 2;
                            
                            // Create collection effect
                            createPowerUpEffect(players[j].x + players[j].width/2, players[j].y + players[j].height/2);
                            
                            // Remove power-up
                            powerUps.splice(i, 1);
                            updateUI();
                            break;
                        }
                    }
                }
                
                // Update explosions
                for (let i = explosions.length - 1; i >= 0; i--) {
                    explosions[i].radius += explosions[i].growth;
                    explosions[i].alpha -= 0.02;
                    
                    if (explosions[i].alpha <= 0) {
                        explosions.splice(i, 1);
                    }
                }
            }
            
            // Respawn player
            function respawnPlayer(player) {
                let newX, newY;
                let validPosition = false;
                
                // Try to find a position away from the other player
                for (let attempts = 0; attempts < 20; attempts++) {
                    newX = Math.random() * (canvas.width - player.width);
                    newY = Math.random() * (canvas.height - player.height);
                    
                    // Check distance from other player
                    const otherPlayer = players[0] === player ? players[1] : players[0];
                    const dx = newX - otherPlayer.x;
                    const dy = newY - otherPlayer.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance > 150) {
                        validPosition = true;
                        break;
                    }
                }
                
                if (!validPosition) {
                    // Fallback if no valid position found after attempts
                    newX = Math.random() * (canvas.width - player.width);
                    newY = Math.random() * (canvas.height - player.height);
                }
                
                player.x = newX;
                player.y = newY;
                player.weaponLevel = Math.max(1, player.weaponLevel * 0.7);
                player.maxHealth = Math.floor(player.weaponLevel) + 2;
                player.health = player.maxHealth;
                player.dependency *= 0.8;
            }
            
            // Render game
            function render() {
                // Clear canvas
                ctx.fillStyle = '#000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw stars
                drawStars();
                
                // Draw power-ups
                powerUps.forEach(powerUp => {
                    ctx.fillStyle = powerUp.color;
                    ctx.beginPath();
                    ctx.arc(powerUp.x, powerUp.y, powerUp.radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Pulsating effect
                    ctx.strokeStyle = 'white';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(powerUp.x, powerUp.y, powerUp.radius + Math.sin(Date.now() / 200) * 2, 0, Math.PI * 2);
                    ctx.stroke();
                });
                
                // Draw bullets
                bullets.forEach(bullet => {
                    ctx.fillStyle = bullet.color;
                    ctx.beginPath();
                    ctx.arc(bullet.x, bullet.y, bullet.radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Add a glow effect to bullets
                    ctx.beginPath();
                    ctx.arc(bullet.x, bullet.y, bullet.radius + 2, 0, Math.PI * 2);
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                    ctx.fill();
                    
                    // Draw warning ring for large bullets
                    if (bullet.radius > 15) {
                        ctx.beginPath();
                        ctx.arc(bullet.x, bullet.y, bullet.radius + 5, 0, Math.PI * 2);
                        ctx.strokeStyle = '#ff0000';
                        ctx.lineWidth = 2;
                        ctx.stroke();
                    }
                });
                
                // Draw players with direction indicators
                players.forEach(player => {
                    // Draw player with flashing effect if recently hit
                    if (player.hitTimer > 0 && player.hitTimer % 4 < 2) {
                        ctx.fillStyle = '#ffffff';
                    } else {
                        ctx.fillStyle = player.color;
                    }
                    
                    // Draw player ship as a triangle facing the last movement direction
                    ctx.save();
                    ctx.translate(player.x + player.width/2, player.y + player.height/2);
                    
                    // Calculate angle based on last movement
                    const angle = Math.atan2(player.lastMoveY, player.lastMoveX);
                    ctx.rotate(angle);
                    
                    ctx.beginPath();
                    ctx.moveTo(player.width/2, 0);
                    ctx.lineTo(-player.width/2, -player.height/2);
                    ctx.lineTo(-player.width/2, player.height/2);
                    ctx.closePath();
                    ctx.fill();
                    
                    ctx.restore();
                    
                    // Draw weapon level indicator
                    ctx.fillStyle = '#ffcc00';
                    ctx.fillRect(player.x, player.y - 10, player.width * (player.weaponLevel / 10), 5);
                    
                    // Draw health bar
                    ctx.fillStyle = '#4CAF50';
                    ctx.fillRect(player.x, player.y - 5, player.width * (player.health / player.maxHealth), 3);
                });
                
                // Draw explosions
                explosions.forEach(explosion => {
                    ctx.globalAlpha = explosion.alpha;
                    ctx.fillStyle = explosion.color;
                    ctx.beginPath();
                    ctx.arc(explosion.x, explosion.y, explosion.radius, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.globalAlpha = 1;
                });
            }
            
            // Draw stars in background
            function drawStars() {
                ctx.fillStyle = '#ffffff';
                for (let i = 0; i < 100; i++) {
                    const x = (i * 13) % canvas.width;
                    const y = (i * 7) % canvas.height;
                    const size = Math.sin(Date.now() / 1000 + i) * 2 + 1;
                    ctx.fillRect(x, y, size, size);
                }
            }
            
            // Shoot bullet in the last movement direction
            function shoot(player) {
                const playerIndex = players.indexOf(player);
                
                // Calculate bullet speed based on weapon level
                const speed = Math.min(100, 5 + (player.weaponLevel * 1.5));
                
                // Normalize direction vector
                const magnitude = Math.sqrt(player.lastMoveX * player.lastMoveX + player.lastMoveY * player.lastMoveY);
                const dirX = player.lastMoveX / magnitude;
                const dirY = player.lastMoveY / magnitude;
                
                bullets.push({
                    x: player.x + (player.width / 2),
                    y: player.y + (player.height / 2),
                    radius: 3 + (player.weaponLevel * 0.5),
                    speedX: dirX * speed,
                    speedY: dirY * speed,
                    color: player.color,
                    playerIndex: playerIndex,
                    level: Math.floor(player.weaponLevel)
                });
            }
            
            // Spawn power-up
            function spawnPowerUp() {
                powerUps.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    radius: 10,
                    color: '#00ff00'
                });
            }
            
            // Create explosion
            function createExplosion(x, y) {
                explosions.push({
                    x: x,
                    y: y,
                    radius: 5,
                    growth: 2,
                    color: '#ff5500',
                    alpha: 1
                });
            }
            
            // Create big explosion
            function createBigExplosion(x, y, power) {
                for (let i = 0; i < 5; i++) {
                    explosions.push({
                        x: x + (Math.random() * 30 - 15),
                        y: y + (Math.random() * 30 - 15),
                        radius: 10 + power,
                        growth: 3 + power/5,
                        color: '#ff5500',
                        alpha: 1
                    });
                }
            }
            
            // Create super explosion for large bullets
            function createSuperExplosion(x, y, radius) {
                explosions.push({
                    x: x,
                    y: y,
                    radius: radius,
                    growth: 5,
                    color: '#ff0000',
                    alpha: 0.7
                });
                
                // Add multiple smaller explosions around the main one
                for (let i = 0; i < 10; i++) {
                    explosions.push({
                        x: x + (Math.random() * radius * 2 - radius),
                        y: y + (Math.random() * radius * 2 - radius),
                        radius: 10 + Math.random() * 10,
                        growth: 2 + Math.random() * 3,
                        color: '#ff5500',
                        alpha: 0.8
                    });
                }
            }
            
            // Create power-up collection effect
            function createPowerUpEffect(x, y) {
                for (let i = 0; i < 10; i++) {
                    explosions.push({
                        x: x,
                        y: y,
                        radius: 2,
                        growth: 1,
                        color: '#00ff00',
                        alpha: 0.8
                    });
                }
            }
            
            // Check collision
            function checkCollision(obj1, obj2) {
                return obj1.x < obj2.x + obj2.width &&
                       obj1.x + (obj1.radius * 2) > obj2.x &&
                       obj1.y < obj2.y + obj2.height &&
                       obj1.y + (obj1.radius * 2) > obj2.y;
            }
            
            // Update UI
            function updateUI() {
                document.getElementById('p1Weapon').textContent = players[0].weaponLevel.toFixed(1);
                document.getElementById('p1WeaponBar').style.width = (players[0].weaponLevel * 10) + '%';
                document.getElementById('p1Health').textContent = players[0].health.toFixed(0);
                document.getElementById('p1MaxHealth').textContent = players[0].maxHealth.toFixed(0);
                document.getElementById('p1HealthBar').style.width = (players[0].health / players[0].maxHealth * 100) + '%';
                document.getElementById('p1Dependency').textContent = players[0].dependency.toFixed(0) + '%';
                document.getElementById('p1DependencyBar').style.width = players[0].dependency + '%';
                document.getElementById('p1Kills').textContent = players[0].kills;
                
                document.getElementById('p2Weapon').textContent = players[1].weaponLevel.toFixed(1);
                document.getElementById('p2WeaponBar').style.width = (players[1].weaponLevel * 10) + '%';
                document.getElementById('p2Health').textContent = players[1].health.toFixed(0);
                document.getElementById('p2MaxHealth').textContent = players[1].maxHealth.toFixed(0);
                document.getElementById('p2HealthBar').style.width = (players[1].health / players[1].maxHealth * 100) + '%';
                document.getElementById('p2Dependency').textContent = players[1].dependency.toFixed(0) + '%';
                document.getElementById('p2DependencyBar').style.width = players[1].dependency + '%';
                document.getElementById('p2Kills').textContent = players[1].kills;
            }
            
            // Initial UI update
            updateUI();
        });
    </script>
</body>
</html>
